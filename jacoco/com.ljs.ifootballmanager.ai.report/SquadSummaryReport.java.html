<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SquadSummaryReport.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">esms-ai</a> &gt; <a href="index.source.html" class="el_package">com.ljs.ifootballmanager.ai.report</a> &gt; <span class="el_source">SquadSummaryReport.java</span></div><h1>SquadSummaryReport.java</h1><pre class="source lang-java linenums">package com.ljs.ifootballmanager.ai.report;

import com.google.common.base.Optional;
import com.google.common.collect.ImmutableSet;
import com.ljs.ifootballmanager.ai.Role;
import com.ljs.ifootballmanager.ai.Tactic;
import com.ljs.ifootballmanager.ai.formation.Formation;
import com.ljs.ifootballmanager.ai.player.Player;
import com.ljs.ifootballmanager.ai.player.Squad;
import com.ljs.ifootballmanager.ai.value.ReplacementLevel;
import com.ljs.ifootballmanager.ai.value.ReplacementLevelHolder;
import java.io.PrintWriter;

/**
 *
 * @author lstephen
 */
public class SquadSummaryReport implements Report {

    private final Squad squad;

    private final Formation firstXI;

    private final Optional&lt;Formation&gt; secondXI;

    private final Optional&lt;Formation&gt; reservesXI;

<span class="nc" id="L28">    private SquadSummaryReport(Builder builder) {</span>
<span class="nc" id="L29">        this.squad = builder.squad;</span>
<span class="nc" id="L30">        this.firstXI = builder.firstXI;</span>
<span class="nc" id="L31">        this.secondXI = builder.secondXI;</span>
<span class="nc" id="L32">        this.reservesXI = builder.reservesXI;</span>
<span class="nc" id="L33">    }</span>

    private Long getMax(Role r, Tactic t, Iterable&lt;Player&gt; ps) {
<span class="nc" id="L36">        return Math.round(Player.byRating(r, t).max(ps).getRating(r, t));</span>
    }

    private Long getMin(Role r, Iterable&lt;Player&gt; ps) {
<span class="nc" id="L40">        return getMin(r, Tactic.NORMAL, ps);</span>
    }

    private Long getMin(Role r, Tactic t, Iterable&lt;Player&gt; ps) {
<span class="nc" id="L44">        return Math.round(Player.byRating(r, t).min(ps).getRating(r, t));</span>
    }

    public void print(PrintWriter w) {
<span class="nc" id="L48">        Role[] roles = Role.values();</span>

<span class="nc" id="L50">        w.format(&quot;%28s &quot;, &quot;&quot;);</span>
<span class="nc bnc" id="L51" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L52">            w.format(&quot;%5s &quot;, r.name());</span>
        }
<span class="nc" id="L54">        w.println();</span>

<span class="nc" id="L56">        w.format(&quot;%28s &quot;, &quot;Count&quot;);</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L58">            w.format(&quot;%5s &quot;, squad.count(r));</span>
        }
<span class="nc" id="L60">        w.println();</span>

<span class="nc" id="L62">        w.format(&quot;%28s &quot;, &quot;Max&quot;);</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L64">           w.format(&quot;%5s &quot;, getMax(r, Tactic.NORMAL, squad.players()));</span>
        }
<span class="nc" id="L66">        w.println();</span>

<span class="nc" id="L68">        w.format(&quot;%28s &quot;, &quot;1st XI (N)&quot;);</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L70">            ImmutableSet&lt;Player&gt; ps = firstXI.players(r);</span>

<span class="nc bnc" id="L72" title="All 2 branches missed.">            w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, ps));</span>
        }
<span class="nc" id="L74">        w.println();</span>

<span class="nc" id="L76">        w.format(&quot;%28s &quot;, &quot;1st XI (&quot; + firstXI.getTactic().getCode() + &quot;)&quot;);</span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L78">            ImmutableSet&lt;Player&gt; ps = firstXI.players(r);</span>

<span class="nc bnc" id="L80" title="All 2 branches missed.">            w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, firstXI.getTactic(), ps));</span>
        }
<span class="nc" id="L82">        w.println();</span>

<span class="nc" id="L84">        ReplacementLevel rl = ReplacementLevelHolder.get();</span>
<span class="nc" id="L85">        w.format(&quot;%28s &quot;, &quot;Replacement (N)&quot;);</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L87">            w.format(&quot;%5s &quot;, Math.round(rl.getReplacementLevel(r, Tactic.NORMAL)));</span>
        }
<span class="nc" id="L89">        w.println();</span>

<span class="nc" id="L91">        w.format(&quot;%28s &quot;, &quot;Replacement (&quot; + firstXI.getTactic().getCode() + &quot;)&quot;);</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">        for (Role r : roles) {</span>
<span class="nc" id="L93">            w.format(&quot;%5s &quot;, Math.round(rl.getReplacementLevel(r, firstXI.getTactic())));</span>
        }
<span class="nc" id="L95">        w.println();</span>

<span class="nc bnc" id="L97" title="All 2 branches missed.">        if (secondXI.isPresent()) {</span>
<span class="nc" id="L98">            w.format(&quot;%28s &quot;, &quot;2nd XI (N)&quot;);</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">            for (Role r : roles) {</span>
<span class="nc" id="L100">                ImmutableSet&lt;Player&gt; ps = secondXI.get().players(r);</span>

<span class="nc bnc" id="L102" title="All 2 branches missed.">                w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, ps));</span>
            }
<span class="nc" id="L104">            w.println();</span>
<span class="nc" id="L105">            w.format(&quot;%28s &quot;, &quot;2nd XI (&quot; + secondXI.get().getTactic().getCode() + &quot;)&quot;);</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">            for (Role r : roles) {</span>
<span class="nc" id="L107">                ImmutableSet&lt;Player&gt; ps = secondXI.get().players(r);</span>

<span class="nc bnc" id="L109" title="All 2 branches missed.">                w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, secondXI.get().getTactic(), ps));</span>
            }
<span class="nc" id="L111">        w.println();</span>
        }

<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (reservesXI.isPresent()) {</span>
<span class="nc" id="L115">            w.format(&quot;%28s &quot;, &quot;Reserves (N)&quot;);</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">            for (Role r : roles) {</span>
<span class="nc" id="L117">                ImmutableSet&lt;Player&gt; ps = reservesXI.get().players(r);</span>

<span class="nc bnc" id="L119" title="All 2 branches missed.">                w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, ps));</span>
            }
<span class="nc" id="L121">            w.println();</span>
<span class="nc" id="L122">            w.format(&quot;%28s &quot;, &quot;Reserves (&quot; + reservesXI.get().getTactic().getCode() + &quot;)&quot;);</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">            for (Role r : roles) {</span>
<span class="nc" id="L124">                ImmutableSet&lt;Player&gt; ps = reservesXI.get().players(r);</span>

<span class="nc bnc" id="L126" title="All 2 branches missed.">                w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, reservesXI.get().getTactic(), ps));</span>
            }
<span class="nc" id="L128">            w.println();</span>
        }

<span class="nc" id="L131">        w.format(&quot;%28s%n&quot;, &quot;Min&quot;);</span>

<span class="nc bnc" id="L133" title="All 2 branches missed.">        for (Tactic t : Tactic.values()) {</span>
<span class="nc" id="L134">            w.format(&quot;%28s &quot;, t);</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">            for (Role r : roles) {</span>
<span class="nc" id="L136">                ImmutableSet&lt;Player&gt; ps = squad.players(r, t);</span>
<span class="nc bnc" id="L137" title="All 2 branches missed.">                w.format(&quot;%5s &quot;, ps.isEmpty() ? &quot;&quot; : getMin(r, t, ps));</span>
            }
<span class="nc" id="L139">            w.println();</span>
        }
<span class="nc" id="L141">    }</span>

    public static Builder builder() {
<span class="nc" id="L144">        return Builder.create();</span>
    }

    private static SquadSummaryReport build(Builder builder) {
<span class="nc" id="L148">        return new SquadSummaryReport(builder);</span>
    }

    public static class Builder {

        private Squad squad;

        private Formation firstXI;

<span class="nc" id="L157">        private Optional&lt;Formation&gt; secondXI = Optional.absent();</span>

<span class="nc" id="L159">        private Optional&lt;Formation&gt; reservesXI = Optional.absent();</span>

<span class="nc" id="L161">        private Builder() { }</span>

        public Builder squad(Squad squad) {
<span class="nc" id="L164">            this.squad = squad;</span>
<span class="nc" id="L165">            return this;</span>
        }

        public Builder firstXI(Formation f) {
<span class="nc" id="L169">            this.firstXI = f;</span>
<span class="nc" id="L170">            return this;</span>
        }

        public Builder secondXI(Formation f) {
<span class="nc" id="L174">            secondXI = Optional.fromNullable(f);</span>
<span class="nc" id="L175">            return this;</span>
        }

        public Builder reservesXI(Formation f) {
<span class="nc" id="L179">            reservesXI = Optional.fromNullable(f);</span>
<span class="nc" id="L180">            return this;</span>
        }

        public SquadSummaryReport build() {
<span class="nc" id="L184">            return SquadSummaryReport.build(this);</span>
        }

        private static Builder create() {
<span class="nc" id="L188">            return new Builder();</span>
        }
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>